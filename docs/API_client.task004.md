# TASK-004: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞ Rapira

## –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â—É—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API –∫–ª–∏–µ–Ω—Ç–∞ Rapira (TASK-004) ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –∫—Ä–∏–ø—Ç–æ-–±–æ—Ç–∞, –æ—Ç–≤–µ—á–∞—é—â–µ–≥–æ –∑–∞ –Ω–∞–¥–µ–∂–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç–Ω—ã—Ö –æ–±–º–µ–Ω–æ–≤ –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ Rapira API.

**–°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
**–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**: 69/69 unit —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç (100%)
**–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**: –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –ø—É–ª–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è:

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–∏–∫–∞ HTTP –∫–ª–∏–µ–Ω—Ç–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
2. **–ü–∞—Ç—Ç–µ—Ä–Ω—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏**: Circuit Breaker, Retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –∏ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π Pydantic –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ Python
4. **Async-First**: –ü–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö Python async/await –¥–ª—è –≤—ã—Å–æ–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
5. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ unit —Ç–µ—Å—Ç–∞–º–∏ —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```mermaid
graph TB
    A[Bot Handlers] --> B[RapiraApiClient]
    B --> C[HTTP Layer]
    C --> D[Rapira API]

    B --> E[Circuit Breaker]
    B --> F[Retry Logic]
    B --> G[Request Metrics]

    H[Pydantic Models] --> B
    I[Configuration] --> B

    J[Cache Service] --> B
    K[Calculation Service] --> B
```

## –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (`src/models/rapira_models.py`)

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

```python
# –ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫—É—Ä—Å–æ–≤ —Å –≤—ã—á–∏—Å–ª—è–µ–º—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
class RapiraRateData(BaseModel):
    """–ö—É—Ä—Å –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π"""

    # –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è API
    symbol: str                    # "BTC/USDT"
    ask_price: float              # –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏
    bid_price: float              # –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏
    close: float                  # –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞

    # –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –±–∏–∑–Ω–µ—Å-—Å–≤–æ–π—Å—Ç–≤–∞
    @property
    def spread(self) -> float:
        """–†–∞—Å—á–µ—Ç —Å–ø—Ä–µ–¥–∞ bid-ask"""
        return self.ask_price - self.bid_price

    @property
    def spread_percentage(self) -> float:
        """–°–ø—Ä–µ–¥ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ü–µ–Ω—ã ask"""
        return (self.spread / self.ask_price) * 100 if self.ask_price > 0 else 0.0
```

#### –û–±–µ—Ä—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ API

```python
class RapiraApiResponse(BaseModel):
    """–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç API —Å –±–∏–∑–Ω–µ—Å-–º–µ—Ç–æ–¥–∞–º–∏"""

    data: list[RapiraRateData]
    code: int                     # 0 = —É—Å–ø–µ—Ö
    message: str
    is_working: int              # 1 = API —Ä–∞–±–æ—Ç–∞–µ—Ç

    def get_rate_by_symbol(self, symbol: str) -> RapiraRateData | None:
        """–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –∫—É—Ä—Å–∞ –ø–æ —Å–∏–º–≤–æ–ª—É"""

    def get_supported_symbols(self) -> list[str]:
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä"""
```

#### –ú–æ–¥–µ–ª—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```python
class RapiraClientConfig(BaseModel):
    """–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π"""

    base_url: str = Field(..., validator=validate_url)
    timeout: int = Field(default=30, ge=5, le=120)
    max_retries: int = Field(default=3, ge=0, le=10)
    retry_delay: float = Field(default=1.0, ge=0.1, le=10.0)
    backoff_factor: float = Field(default=2.0, ge=1.0, le=5.0)
    circuit_breaker_threshold: int = Field(default=5, ge=1, le=20)
    circuit_breaker_timeout: int = Field(default=60, ge=10, le=300)
```

### 2. HTTP –∫–ª–∏–µ–Ω—Ç (`src/services/rapira_client.py`)

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞

```python
class RapiraApiClient:
    """–ü—Ä–æ–¥–∞–∫—à–µ–Ω-–≥–æ—Ç–æ–≤—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç —Å –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏"""

    def __init__(self, config: RapiraClientConfig):
        self.config = config
        self.circuit_breaker = CircuitBreakerState()
        self.metrics = RapiraRequestMetrics()
        self._client: httpx.AsyncClient | None = None

    async def __aenter__(self) -> RapiraApiClient:
        """Context manager –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏"""
        await self._ensure_client()
        return self

    async def __aexit__(self, exc_type, exc_val, exc_tb) -> None:
        """–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π"""
        await self.close()
```

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

##### –ü–∞—Ç—Ç–µ—Ä–Ω Circuit Breaker

```python
def _check_circuit_breaker(self) -> None:
    """–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤ —Å –ª–æ–≥–∏–∫–æ–π circuit breaker"""

    if not self.circuit_breaker.is_open:
        return

    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞
    if self._should_attempt_recovery():
        self.circuit_breaker.half_open_circuit()
        return

    raise RapiraCircuitBreakerError(
        f"Circuit breaker –æ—Ç–∫—Ä—ã—Ç. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–±–æ–π: {self.circuit_breaker.last_failure_time}"
    )

def _should_attempt_recovery(self) -> bool:
    """–£–º–Ω–æ–µ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å–±–æ–µ–≤"""
    return (
        self.circuit_breaker.last_failure_time and
        datetime.now() - self.circuit_breaker.last_failure_time >
        timedelta(seconds=self.config.circuit_breaker_timeout)
    )
```

##### –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

```python
async def _make_request(self, endpoint: str) -> dict[str, Any]:
    """–£—Å—Ç–æ–π—á–∏–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏"""

    for attempt in range(self.config.max_retries + 1):
        try:
            response = await self._execute_request(endpoint)

            # –ü—É—Ç—å —É—Å–ø–µ—Ö–∞
            self._handle_circuit_breaker_success()
            self.metrics.record_request(True, response_time)
            return self._process_response(response)

        except RetryableException as e:
            if attempt < self.config.max_retries:
                delay = self._calculate_retry_delay(attempt)
                await asyncio.sleep(delay)
                continue
            raise

        except NonRetryableException:
            # –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —Å–±–æ–π –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
            raise

def _calculate_retry_delay(self, attempt: int) -> float:
    """–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å –¥–∂–∏—Ç—Ç–µ—Ä–æ–º"""
    base_delay = self.config.retry_delay
    backoff = self.config.backoff_factor ** attempt
    jitter = random.uniform(0.8, 1.2)  # ¬±20% –¥–∂–∏—Ç—Ç–µ—Ä
    return base_delay * backoff * jitter
```

#### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

```python
# –ò–µ—Ä–∞—Ä—Ö–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è —Ç–æ—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
class RapiraApiException(Exception):
    """–ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—à–∏–±–∫–µ"""

    def __init__(self, message: str, error_code: int = None, details: str = None):
        self.message = message
        self.error_code = error_code
        self.details = details

class RapiraClientError(RapiraApiException):
    """–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –æ—à–∏–±–∫–∏ 4xx - –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–∞"""

class RapiraServerError(RapiraApiException):
    """–°–µ—Ä–≤–µ—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ 5xx - –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å"""

class RapiraRateLimitError(RapiraApiException):
    """–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 429 - —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞"""

class RapiraCircuitBreakerError(RapiraApiException):
    """–ó–∞—â–∏—Ç–∞ circuit breaker –∞–∫—Ç–∏–≤–Ω–∞"""
```

### 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Factory

```python
class RapiraClientFactory:
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞"""

    @staticmethod
    def create_client(
        base_url: str,
        timeout: int = 30,
        max_retries: int = 3,
        **kwargs
    ) -> RapiraApiClient:
        """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ —Å —è–≤–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏"""
        config = RapiraClientConfig(
            base_url=base_url,
            timeout=timeout,
            max_retries=max_retries,
            **kwargs
        )
        return RapiraApiClient(config)

    @staticmethod
    def create_from_settings(settings: Any) -> RapiraApiClient:
        """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        config = RapiraClientConfig(
            base_url=settings.RAPIRA_API_URL,
            timeout=settings.RAPIRA_TIMEOUT,
            max_retries=settings.RAPIRA_MAX_RETRIES,
        )
        return RapiraApiClient(config)
```

## –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏

- **–ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**: –ú–∞–∫—Å–∏–º—É–º 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å 5 keep-alive
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ç–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ (5-120 —Å–µ–∫—É–Ω–¥)
- **–û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ context managers

### –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

```python
class RapiraRequestMetrics(BaseModel):
    """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏"""

    total_requests: int = 0
    successful_requests: int = 0
    failed_requests: int = 0
    avg_response_time: float = 0.0

    @property
    def success_rate(self) -> float:
        """–†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"""
        if self.total_requests == 0:
            return 100.0
        return (self.successful_requests / self.total_requests) * 100

    def record_request(self, success: bool, response_time: float) -> None:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞"""
        self.total_requests += 1
        if success:
            self.successful_requests += 1
        else:
            self.failed_requests += 1

        # –†–∞—Å—á–µ—Ç —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ
        self.avg_response_time = (
            (self.avg_response_time * (self.total_requests - 1) + response_time) /
            self.total_requests
        )
```

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from src.services.rapira_client import RapiraClientFactory
from src.models.rapira_models import RapiraClientConfig

# –ú–µ—Ç–æ–¥ 1: –§–∞–±—Ä–∏–∫–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
client = RapiraClientFactory.create_client(
    base_url="https://api.rapira.net",
    timeout=30,
    max_retries=3
)

# –ú–µ—Ç–æ–¥ 2: –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
config = RapiraClientConfig(
    base_url="https://api.rapira.net",
    timeout=30,
    max_retries=3,
    circuit_breaker_threshold=5
)
client = RapiraApiClient(config)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å context manager (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
async with client:
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
    response = await client.get_market_rates()

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã
    btc_rate = await client.get_rate_by_symbol("BTC/USDT")

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
    is_healthy = await client.health_check()

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    metrics = client.get_metrics()
    print(f"–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {metrics.success_rate}%")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –±–æ—Ç–∞

```python
async def handle_rate_command(message: Message, client: RapiraApiClient):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"""

    try:
        async with client:
            rate = await client.get_rate_by_symbol("BTC/USDT")

            if rate:
                await message.answer(
                    f"üí∞ –ö—É—Ä—Å BTC/USDT\n"
                    f"–¢–µ–∫—É—â–∏–π: ${rate.close:,.2f}\n"
                    f"–°–ø—Ä–µ–¥: {rate.spread_percentage:.2f}%"
                )
            else:
                await message.answer("‚ùå –ö—É—Ä—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")

    except RapiraRateLimitError:
        await message.answer("‚è∞ –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ")

    except RapiraCircuitBreakerError:
        await message.answer("üîß –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")

    except RapiraApiException as e:
        logger.error(f"–û—à–∏–±–∫–∞ API: {e.message}", extra={"error_code": e.error_code})
        await message.answer("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å—ã")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–µ—Ä–≤–∏—Å–æ–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

```python
async def get_cached_rate(
    symbol: str,
    client: RapiraApiClient,
    cache: CacheService
) -> RapiraRateData | None:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–∞ —Å fallback –Ω–∞ –∫–µ—à"""

    # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∫–µ—à
    cached_rate = await cache.get_rate(symbol)
    if cached_rate and not cache.is_expired(cached_rate):
        return cached_rate

    # Fallback –Ω–∞ API
    try:
        async with client:
            fresh_rate = await client.get_rate_by_symbol(symbol)
            if fresh_rate:
                await cache.set_rate(symbol, fresh_rate, ttl=300)  # –ö–µ—à –Ω–∞ 5 –º–∏–Ω
            return fresh_rate

    except RapiraApiException:
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–µ—à –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        return cached_rate
```

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–æ–∫—Ä—ã—Ç–∏–µ Unit —Ç–µ—Å—Ç–∞–º–∏

**–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 69/69 –ø—Ä–æ—Ö–æ–¥—è—Ç (100% —É—Å–ø–µ—à–Ω—ã—Ö)
- **–¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π**: 27 —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é, –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- **–¢–µ—Å—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞**: 42 —Ç–µ—Å—Ç–∞ –ø–æ–∫—Ä—ã–≤–∞—é—Ç HTTP –æ–ø–µ—Ä–∞—Ü–∏–∏, –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫, –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤

#### 1. –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π
```python
def test_rate_data_validation():
    """–¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ Pydantic"""

def test_computed_properties():
    """–¢–µ—Å—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –≤ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö"""

def test_edge_cases():
    """–¢–µ—Å—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å, –Ω–µ–≤–µ—Ä–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏ —Ç.–¥."""
```

#### 2. –¢–µ—Å—Ç—ã HTTP –∫–ª–∏–µ–Ω—Ç–∞
```python
@pytest.mark.asyncio
async def test_successful_request():
    """–¢–µ—Å—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ API –∑–∞–ø—Ä–æ—Å–∞"""

@pytest.mark.asyncio
async def test_retry_on_server_error():
    """–¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ –ø–æ–≤—Ç–æ—Ä–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏ 5xx"""

@pytest.mark.asyncio
async def test_circuit_breaker_functionality():
    """–¢–µ—Å—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π circuit breaker"""
```

#### 3. –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
```python
@pytest.mark.asyncio
async def test_rate_limit_handling():
    """–¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–∫–∏ 429"""

@pytest.mark.asyncio
async def test_timeout_handling():
    """–¢–µ—Å—Ç —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Ç–∞–π–º–∞—É—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞"""
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è

```python
@pytest.fixture
def mock_httpx_client():
    """–ú–æ–∫ httpx –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    with patch('httpx.AsyncClient') as mock:
        yield mock

@pytest.fixture
def sample_api_response():
    """–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    return {
        "data": [
            {
                "symbol": "BTC/USDT",
                "askPrice": 45000.0,
                "bidPrice": 44950.0,
                "close": 44975.0,
                # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
            }
        ],
        "code": 0,
        "message": "success",
        "isWorking": 1
    }
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
RAPIRA_API_URL=https://api.rapira.net

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
RAPIRA_TIMEOUT=30
RAPIRA_MAX_RETRIES=3
RAPIRA_RETRY_DELAY=1.0
RAPIRA_BACKOFF_FACTOR=2.0
RAPIRA_CIRCUIT_BREAKER_THRESHOLD=5
RAPIRA_CIRCUIT_BREAKER_TIMEOUT=60
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Pydantic:
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ URL
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- –ü—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫

–ö–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤—Å–µ–≥–æ, —É—Å–ø–µ—à–Ω—ã—Ö, –Ω–µ—É–¥–∞—á–Ω—ã—Ö)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —É—Å–ø–µ—Ö–∞/–Ω–µ—É–¥–∞—á
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è circuit breaker

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```python
import structlog

logger = structlog.get_logger(__name__)

# –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤—Å–µ–º—É –∫–ª–∏–µ–Ω—Ç—É
logger.info(
    "API –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω",
    symbol=symbol,
    response_time=response_time,
    success=True,
    circuit_breaker_state=self.circuit_breaker.state
)
```

### Endpoint –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è

```python
async def health_check(self) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞"""
    try:
        response = await self.get_market_rates()
        return response.is_api_working and len(response.data) > 0
    except Exception:
        return False
```

## –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### HTTP –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–¢–æ–ª—å–∫–æ HTTPS**: –í–∞–ª–∏–¥–∞—Ü–∏—è URL –ø—Ä–∏–Ω—É–∂–¥–∞–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª HTTPS
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ SSL**: –í–∫–ª—é—á–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã User-Agent –∏ Accept –∑–∞–≥–æ–ª–æ–≤–∫–∏
- **–õ–∏–º–∏—Ç—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∞—Ç–∞–∫–∏ –∏—Å—Ç–æ—â–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–∞—Ö

- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ API —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –∏–∑ –ª–æ–≥–æ–≤
- –ö–æ–¥—ã –æ—à–∏–±–æ–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º

- **–ü–∞–º—è—Ç—å**: ~10–ú–ë –±–∞–∑–æ–≤–∞—è + –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **CPU**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–≤—è–∑–∞–Ω—ã —Å async I/O
- **–°–µ—Ç—å**: –ò—Å—Ö–æ–¥—è—â–∏–π HTTPS –∫ api.rapira.net

### –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –Ω–µ –¥–µ–ª—è—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ**: –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç—å—é
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—â–µ–Ω–∏–µ –∫–≤–æ—Ç—ã API

### –ê–ª–µ—Ä—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∞–ª–µ—Ä—Ç—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–ø–µ—Ö–∞ < 95%
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ > 5 —Å–µ–∫—É–Ω–¥
- –°–æ—Å—Ç–æ—è–Ω–∏–µ circuit breaker –æ—Ç–∫—Ä—ã—Ç–æ
- –í—ã—Å–æ–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–≤—Ç–æ—Ä–æ–≤ (> 20%)

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤**: HTTP-—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å ETags
2. **–°–∂–∞—Ç–∏–µ**: –°–∂–∞—Ç–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ gzip/deflate
3. **–≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫**: Endpoint –º–µ—Ç—Ä–∏–∫ Prometheus
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏**: –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
5. **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–≤–æ–ª—é—Ü–∏–∏ API

- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ endpoints API
- –°–ª–æ–∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ Rapira API –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–≥–æ—Ç–æ–≤—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç. –° –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫, –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ –ø–æ–ª–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º —Ç–µ—Å—Ç–∞–º–∏, –æ–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
- ‚úÖ 100% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (69/69 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- ‚úÖ –ü—Ä–æ–¥–∞–∫—à–µ–Ω-–≥–æ—Ç–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π Pydantic
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å
- ‚úÖ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–∏—Å–æ–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (TASK-005) –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã.

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-12-19
**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏**: –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
